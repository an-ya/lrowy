<!DOCTYPE html>
<html lang="zh" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>编辑工具</title>
    <meta name="renderer" content="webkit">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="user-scalable=no, width=device-width, initial-scale=1.0, maximum-scale=1.0">
    <link rel="stylesheet" th:href="@{/css/common2.css}">
    <link rel="stylesheet" th:href="@{/css/nvi-notice.css}">
    <link rel="stylesheet" th:href="@{/css/ivu-message.css}">
    <link rel="stylesheet" th:href="@{/cherry-markdown/cherry-markdown.min.css}">
    <style>
        .header {display: flex;justify-content: space-between;align-items: center;height: 50px;padding: 0 20px;font-size: 18px;font-weight: bold;}
        .main {position: absolute;top: 50px;left: 0;right: 0;bottom: 0;display: flex;justify-content: center;padding: 10px;background-color: #f2f2f2;}
        .main .left-side{flex-shrink: 0;width:240px;margin-right: 10px;background-color:#f8fafb;}
        .main .right-side{position: relative;display: flex;flex-direction: column;width: 960px;background-color: #fff;border-top: 1px solid #e5e5e5;}
        .main .right-side .info {display: flex;align-items: center;height: 64px;padding: 16px 32px;font-size: 15px;font-weight: bold;}
        .main .right-side .editor {position: absolute;top: 64px;left: 0;right: 0;bottom: 0;}
        .cherry{box-shadow: none;}
        .cherry-toolbar{box-shadow: none;}
        .cherry-dropdown{box-shadow: 0 0 10px rgba(128, 145, 165, .2);}
        .cherry-previewer{border-width: 1px;}
    </style>
</head>
<body>
<div class="header">Admin<a>登录</a></div>
<div class="main">
    <div class="left-side"></div>
    <div class="right-side">
        <div class="info">CentOS Mysql安装教程</div>
        <div class="editor">
            <div  id="markdown"></div>
        </div>
    </div>
</div>
<script src="https://cdn.bootcss.com/jquery/3.4.0/jquery.min.js"></script>
<script th:src="@{/js/common-v2.js}"></script>
<script th:src="@{/js/nvi-notice.js}"></script>
<script th:src="@{/js/ivu-message.js}"></script>
<script th:src="@{/cherry-markdown/cherry-markdown.min.js}"></script>
<script>
    var CustomHookA = Cherry.createSyntaxHook('codeBlock', Cherry.constants.HOOKS_TYPE_LIST.PAR, {
        makeHtml(str) {
            console.warn('custom hook', 'hello');
            return str;
        },
        rule(str) {
            const regex = {
                begin: '',
                content: '',
                end: '',
            };
            regex.reg = new RegExp(regex.begin + regex.content + regex.end, 'g');
            return regex;
        },
    });

    var basicConfig = {
        id: 'markdown',
        externals: {
            echarts: window.echarts,
            katex: window.katex,
            MathJax: window.MathJax,
        },
        isPreviewOnly: false,
        engine: {
            global: {
                urlProcessor(url, srcType) {
                    console.log(`url-processor`, url, srcType);
                    return url;
                },
            },
            syntax: {
                table: {
                    enableChart: false,
                    // chartEngine: Engine Class
                },
                fontEmphasis: {
                    allowWhitespace: true, // 是否允许首尾空格
                },
                mathBlock: {
                    engine: 'MathJax', // katex或MathJax
                    src: 'https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-svg.js', // 如果使用MathJax plugins，则需要使用该url通过script标签引入
                },
                inlineMath: {
                    engine: 'MathJax', // katex或MathJax
                },
                emoji: {
                    useUnicode: false,
                    customResourceURL: 'https://github.githubassets.com/images/icons/emoji/unicode/${code}.png?v8',
                    upperCase: true,
                },
                // toc: {
                //     tocStyle: 'nested'
                // }
                // 'header': {
                //   strict: false
                // }
            },
            customSyntax: {
                // SyntaxHookClass
                CustomHook: {
                    syntaxClass: CustomHookA,
                    force: false,
                    after: 'br',
                },
            },
        },
        toolbars: {
            theme: 'light',
            toolbar: [
                'bold',
                'italic',
                'strikethrough',
                '|',
                'color',
                'header',
                '|',
                'list',
                {
                    insert: ['image', 'audio', 'video', 'link', 'hr', 'br', 'code', 'formula', 'toc', 'table', 'pdf', 'word'],
                },
                'graph',
                'togglePreview',
                'settings',
                'switchModel',
                'codeTheme',
                'export',
            ],
            sidebar: ['mobilePreview', 'copy'],
        },
        editor: {
            defaultModel: 'edit&preview',
        },
        previewer: {
            // 自定义markdown预览区域class
            // className: 'markdown'
        },
        keydown: [],
        //extensions: [],
    };

    var config = Object.assign({}, basicConfig, { value: '' });
    window.cherry = new Cherry(config);
</script>
</body>
</html>